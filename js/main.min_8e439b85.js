var __reflect=this&&this.__reflect||function(t,e,o){t.__class__=e,o?o.push(e):o=[e],t.__types__=t.__types__?o.concat(t.__types__):o},__extends=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);o.prototype=e.prototype,t.prototype=new o},__awaiter=this&&this.__awaiter||function(t,e,o,i){return new(o||(o=Promise))(function(r,s){function n(t){try{a(i.next(t))}catch(e){s(e)}}function h(t){try{a(i["throw"](t))}catch(e){s(e)}}function a(t){t.done?r(t.value):new o(function(e){e(t.value)}).then(n,h)}a((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function o(t){return function(e){return i([t,e])}}function i(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,s&&(n=s[2&o[0]?"return":o[0]?"throw":"next"])&&!(n=n.call(s,o[1])).done)return n;switch(s=0,n&&(o=[0,n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,s=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(n=a.trys,!(n=n.length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(i){o=[6,i],s=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r,s,n,h,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return h={next:o(0),"throw":o(1),"return":o(2)},"function"==typeof Symbol&&(h[Symbol.iterator]=function(){return this}),h},HotDog=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},e.prototype.init=function(){this.hotDog=this.createBitmapByName("regou_png"),this.hotDogXMax=this.stage.stageWidth-this.hotDog.width,this.hotDogYMax=this.stage.stageHeight-this.hotDog.height,this.addChild(this.hotDog)},e}(egret.DisplayObjectContainer);__reflect(HotDog.prototype,"HotDog");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="加载中..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var e=t.call(this)||this;return e.timeOnEnterFrame=0,e.maxHotDogCount=10,e.hotDogCount=e.maxHotDogCount,e.hitHotDogCount=0,e.gameStatus=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return o.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return o.sent(),this.stage.removeChild(t),this.voiceBonus=RES.getRes("point_mp3"),this.voiceOver=RES.getRes("die_mp3"),this.voiceLaunch=RES.getRes("launch_mp3"),[3,4];case 3:return e=o.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){this.bgShp=new egret.Shape,this.bgShp.graphics.beginFill(15526636,1),this.bgShp.graphics.drawRect(0,0,this.stage.stageWidth,this.stage.stageHeight),this.bgShp.graphics.endFill(),this.bgShp.touchEnabled=!0,this.bgShp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchState,this),this.addChild(this.bgShp),this.schoolMaster=new SchoolMaster,this.addChild(this.schoolMaster),this.hotDog=this.createBitmapByName("regou_png"),this.addChild(this.hotDog),this.hotDogXMin=this.schoolMaster.bottomPointX,this.hotDogXMax=this.stage.stageWidth-this.schoolMaster.topPointX-this.hotDog.width,this.hotDogYMax=this.stage.stageHeight-this.hotDog.height,this.hotDog.x=this.getHotDogX(),this.hotDog.y=this.hotDogYMax,this.textField=new egret.TextField,this.textField.x=0,this.textField.y=this.stage.stageHeight-40,this.textField.width=120,this.textField.height=40,this.textField.textAlign="center",this.textField.textColor=13369344,this.setTextField(),this.addChild(this.textField),this.scoreTextField=new egret.TextField,this.scoreTextField.y=200,this.scoreTextField.x=315,this.scoreTextField.textColor=13369344,this.scoreTextField.text=this.hitHotDogCount+"",this.addChild(this.scoreTextField),this.tipImg=this.createBitmapByName("tip_png"),this.addChild(this.tipImg),this.tipImg.x=(this.stage.stageWidth-this.tipImg.width)/2,this.tipImg.y=(this.stage.stageHeight-this.tipImg.height)/2,this.scoreboardImg=new ScoreBoard,this.swapChildren(this.hotDog,this.schoolMaster)},e.prototype.setTextField=function(){this.textField.text="剩余:"+this.hotDogCount},e.prototype.onTouchState=function(){0===this.gameStatus?(this.removeChild(this.tipImg),this.schoolMaster.resume(),this.gameStatus=1):1===this.gameStatus?(this.voiceLaunch.play(0,1),this.hotDogCount--,this.setTextField(),this.launchHotDog()):2===this.gameStatus&&(this.removeChild(this.scoreboardImg),this.addChild(this.tipImg),this.gameStatus=0,this.hotDogCount=this.maxHotDogCount,this.hitHotDogCount=0,this.scoreTextField.text=this.hitHotDogCount+"",this.setTextField())},e.prototype.launchHotDog=function(){var t=this;this.bgShp.touchEnabled=!1;var e=egret.Tween.get(this.hotDog,{loop:!1}),o=this.schoolMaster.height-1,i=!1;e.to({y:o},1500).call(function(){i=t.schoolMaster.hitTestPoint(t.hotDog.x+t.hotDog.width/2,o),i?(t.hitHotDogCount++,t.scoreTextField.text=t.hitHotDogCount+"",t.schoolMaster.pause(),t.voiceBonus.play(0,1)):t.voiceOver.play(0,1)}).to({y:5},200).call(function(){egret.Tween.removeTweens(t.hotDog),t.hotDog.x=t.getHotDogX(),t.hotDog.y=t.hotDogYMax,t.hotDogCount<=0?(t.addChild(t.scoreboardImg),t.scoreboardImg.x=(t.stage.stageWidth-t.scoreboardImg.scoreBoard.width)/2,t.scoreboardImg.y=(t.stage.stageHeight-t.scoreboardImg.scoreBoard.height)/2,t.scoreboardImg.setCurrentPoint(t.hitHotDogCount),t.gameStatus=2):t.schoolMaster.resume(),t.bgShp.touchEnabled=!0})},e.prototype.getHotDogX=function(){return(this.hotDogXMax-this.hotDogXMin)*Math.random()+this.hotDogXMin},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var SchoolMaster=function(t){function e(){var e=t.call(this)||this;return e.paused=!1,e.bottomPointX=18,e.topPointX=38,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},e.prototype.pause=function(){this.paused=!0,egret.Tween.pauseTweens(this.schoolMaster)},e.prototype.resume=function(){this.paused=!1,egret.Tween.resumeTweens(this.schoolMaster)},e.prototype.init=function(){this.schoolMaster=this.createBitmapByName("xiaozhang_png"),this.schoolMaster.x=0,this.schoolMaster.y=0,this.personXMax=this.stage.width-this.schoolMaster.width;var t=egret.Tween.get(this.schoolMaster,{loop:!0});t.to({x:this.personXMax},2e3).wait(100).to({x:0},2e3).wait(100),this.addChild(this.schoolMaster),this.pause()},e}(egret.DisplayObjectContainer);__reflect(SchoolMaster.prototype,"SchoolMaster");var ScoreBoard=function(t){function e(){var e=t.call(this)||this;return e.currentPoint=0,e.maxPoint=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e}return __extends(e,t),e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap;return e.texture=RES.getRes(t),e},e.prototype.setCurrentPoint=function(t){this.currentPoint=t,t>this.maxPoint&&(this.maxPoint=t),this.currentPointText.text=this.currentPoint+"",this.maxPointText.text=this.maxPoint+""},e.prototype.init=function(){var t=new egret.DisplayObjectContainer;this.scoreBoard=this.createBitmapByName("scoreboard_png"),t.width=this.scoreBoard.width,t.height=this.scoreBoard.height,this.width=t.width,this.height=t.height,t.addChild(this.scoreBoard),this.currentPointText=new egret.TextField,this.maxPointText=new egret.TextField,t.addChild(this.currentPointText),t.addChild(this.maxPointText),console.log(this.scoreBoard),this.currentPointText.y=this.scoreBoard.height/2.5,this.currentPointText.textColor=13369344,this.maxPointText.textColor=13369344,this.maxPointText.y=this.scoreBoard.height/1.65,this.currentPointText.x=this.scoreBoard.width/2,this.maxPointText.x=this.scoreBoard.width/2,this.addChild(t)},e}(egret.DisplayObjectContainer);__reflect(ScoreBoard.prototype,"ScoreBoard");